<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>PyForensicKit Report - {{ case.case_id if case else "N/A" }}</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 30px; }
        h1, h2 { color: #2c3e50; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        th, td { border: 1px solid #bdc3c7; padding: 8px; text-align: left; }
        th { background-color: #ecf0f1; }
        tr:nth-child(even) { background-color: #f8f8f8; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>PyForensicKit Forensic Report</h1>

    <h2>Case Information</h2>
    {% if case %}
    <ul>
        <li><strong>Case ID:</strong> {{ case.case_id }}</li>
        <li><strong>Investigator:</strong> {{ case.investigator }}</li>
        <li><strong>Description:</strong> {{ case.description }}</li>
        <li><strong>Analysis Started (UTC):</strong> {{ case.analysis_started_utc }}</li>
    </ul>
    {% else %}
    <p>No case information provided.</p>
    {% endif %}

    <h2>File Metadata & Hashes</h2>
    <table>
        <tr>
            <th>File Path</th>
            <th>MD5</th>
            <th>SHA1</th>
            <th>SHA256</th>
        </tr>
        {% for f, h in hashes.items() %}
        <tr>
            <td>{{ f }}</td>
            {% if h.error %}
            <td colspan="3" class="error">{{ h.error }}</td>
            {% else %}
            <td>{{ h.md5 }}</td>
            <td>{{ h.sha1 }}</td>
            <td>{{ h.sha256 }}</td>
            {% endif %}
        </tr>
        {% endfor %}
    </table>

    <h2>Timeline (first 20 events)</h2>
    <table>
        <tr>
            <th>Timestamp</th>
            <th>Event</th>
            <th>File Path</th>
        </tr>
        {% for event in timeline[:20] %}
        <tr>
            <td>{{ event.timestamp }}</td>
            <td>{{ event.event }}</td>
            <td>{{ event.path }}</td>
        </tr>
        {% endfor %}
    </table>

    {% if integrity_verification %}
    <h2>Evidence Integrity Verification</h2>
    <table>
        <tr>
            <th>File Path</th>
            <th>Integrity Pass</th>
        </tr>
        {% for f, result in integrity_verification.integrity_pass.items() %}
        <tr>
            <td>{{ f }}</td>
            <td>{{ result if result is not none else "Cannot verify" }}</td>
        </tr>
        {% endfor %}
    </table>
    {% endif %}

</body>
</html>
